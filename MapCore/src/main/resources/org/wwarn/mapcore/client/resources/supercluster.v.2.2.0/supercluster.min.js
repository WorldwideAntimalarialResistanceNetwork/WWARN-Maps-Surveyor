!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var o;o="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,o.supercluster=t()}}(function(){return function t(o,n,e){function i(s,u){if(!n[s]){if(!o[s]){var a="function"==typeof require&&require;if(!u&&a)return a(s,!0);if(r)return r(s,!0);var h=new Error("Cannot find module '"+s+"'");throw h.code="MODULE_NOT_FOUND",h}var p=n[s]={exports:{}};o[s][0].call(p.exports,function(t){var n=o[s][1][t];return i(n?n:t)},p,p.exports,t,o,n,e)}return n[s].exports}for(var r="function"==typeof require&&require,s=0;s<e.length;s++)i(e[s]);return i}({1:[function(t,o){"use strict";function n(t){return new e(t)}function e(t){this.options=c(Object.create(this.options),t),this.trees=new Array(this.options.maxZoom+1)}function i(t,o,n,e){return{x:t,y:o,zoom:1/0,id:e,numPoints:n}}function r(t,o){var n=t.geometry.coordinates;return i(a(n[0]),h(n[1]),1,o)}function s(t){return{type:"Feature",properties:u(t),geometry:{type:"Point",coordinates:[p(t.x),f(t.y)]}}}function u(t){var o=t.numPoints,n=o>=1e4?Math.round(o/1e3)+"k":o>=1e3?Math.round(o/100)/10+"k":o;return{cluster:!0,point_count:o,point_count_abbreviated:n}}function a(t){return t/360+.5}function h(t){var o=Math.sin(t*Math.PI/180),n=.5-.25*Math.log((1+o)/(1-o))/Math.PI;return 0>n?0:n>1?1:n}function p(t){return 360*(t-.5)}function f(t){var o=(180-360*t)*Math.PI/180;return 360*Math.atan(Math.exp(o))/Math.PI-90}function c(t,o){for(var n in o)t[n]=o[n];return t}function d(t){return t.x}function l(t){return t.y}var m=t("kdbush");o.exports=n,e.prototype={options:{minZoom:0,maxZoom:16,radius:40,extent:512,nodeSize:64,log:!1},load:function(t){var o=this.options.log;o&&console.time("total time");var n="prepare "+t.length+" points";o&&console.time(n),this.points=t;var e=t.map(r);o&&console.timeEnd(n);for(var i=this.options.maxZoom;i>=this.options.minZoom;i--){var s=+Date.now();this.trees[i+1]=m(e,d,l,this.options.nodeSize,Float32Array),e=this._cluster(e,i),o&&console.log("z%d: %d clusters in %dms",i,e.length,+Date.now()-s)}return this.trees[this.options.minZoom]=m(e,d,l,this.options.nodeSize,Float32Array),o&&console.timeEnd("total time"),this},getClusters:function(t,o){for(var n=this.trees[this._limitZoom(o)],e=n.range(a(t[0]),h(t[3]),a(t[2]),h(t[1])),i=[],r=0;r<e.length;r++){var u=n.points[e[r]];i.push(-1!==u.id?this.points[u.id]:s(u))}return i},getTile:function(t,o,n){var e=this.trees[this._limitZoom(t)],i=Math.pow(2,t),r=this.options.extent,s=this.options.radius,u=s/r,a=(n-u)/i,h=(n+1+u)/i,p={features:[]};return this._addTileFeatures(e.range((o-u)/i,a,(o+1+u)/i,h),e.points,o,n,i,p),0===o&&this._addTileFeatures(e.range(1-u/i,a,1,h),e.points,i,n,i,p),o===i-1&&this._addTileFeatures(e.range(0,a,u/i,h),e.points,-1,n,i,p),p.features.length?p:null},_addTileFeatures:function(t,o,n,e,i,r){for(var s=0;s<t.length;s++){var a=o[t[s]];r.features.push({type:1,geometry:[[Math.round(this.options.extent*(a.x*i-n)),Math.round(this.options.extent*(a.y*i-e))]],tags:-1!==a.id?this.points[a.id].properties:u(a)})}},_limitZoom:function(t){return Math.max(this.options.minZoom,Math.min(t,this.options.maxZoom+1))},_cluster:function(t,o){for(var n=[],e=this.options.radius/(this.options.extent*Math.pow(2,o)),r=0;r<t.length;r++){var s=t[r];if(!(s.zoom<=o)){s.zoom=o;for(var u=this.trees[o+1],a=u.within(s.x,s.y,e),h=!1,p=s.numPoints,f=s.x*p,c=s.y*p,d=0;d<a.length;d++){var l=u.points[a[d]];o<l.zoom&&(h=!0,l.zoom=o,f+=l.x*l.numPoints,c+=l.y*l.numPoints,p+=l.numPoints)}n.push(h?i(f/p,c/p,p,-1):s)}}return n}}},{kdbush:2}],2:[function(t,o){"use strict";function n(t,o,n,i,r){return new e(t,o,n,i,r)}function e(t,o,n,e,u){o=o||i,n=n||r,u=u||Array,this.nodeSize=e||64,this.points=t,this.ids=new u(t.length),this.coords=new u(2*t.length);for(var a=0;a<t.length;a++)this.ids[a]=a,this.coords[2*a]=o(t[a]),this.coords[2*a+1]=n(t[a]);s(this.ids,this.coords,this.nodeSize,0,this.ids.length-1,0)}function i(t){return t[0]}function r(t){return t[1]}var s=t("./sort"),u=t("./range"),a=t("./within");o.exports=n,e.prototype={range:function(t,o,n,e){return u(this.ids,this.coords,t,o,n,e,this.nodeSize)},within:function(t,o,n){return a(this.ids,this.coords,t,o,n,this.nodeSize)}}},{"./range":3,"./sort":4,"./within":5}],3:[function(t,o){"use strict";function n(t,o,n,e,i,r,s){for(var u,a,h=[0,t.length-1,0],p=[];h.length;){var f=h.pop(),c=h.pop(),d=h.pop();if(s>=c-d)for(var l=d;c>=l;l++)u=o[2*l],a=o[2*l+1],u>=n&&i>=u&&a>=e&&r>=a&&p.push(t[l]);else{var m=Math.floor((d+c)/2);u=o[2*m],a=o[2*m+1],u>=n&&i>=u&&a>=e&&r>=a&&p.push(t[m]);var v=(f+1)%2;(0===f?u>=n:a>=e)&&(h.push(d),h.push(m-1),h.push(v)),(0===f?i>=u:r>=a)&&(h.push(m+1),h.push(c),h.push(v))}}return p}o.exports=n},{}],4:[function(t,o){"use strict";function n(t,o,i,r,s,u){if(!(i>=s-r)){var a=Math.floor((r+s)/2);e(t,o,a,r,s,u%2),n(t,o,i,r,a-1,u+1),n(t,o,i,a+1,s,u+1)}}function e(t,o,n,r,s,u){for(;s>r;){if(s-r>600){var a=s-r+1,h=n-r+1,p=Math.log(a),f=.5*Math.exp(2*p/3),c=.5*Math.sqrt(p*f*(a-f)/a)*(0>h-a/2?-1:1),d=Math.max(r,Math.floor(n-h*f/a+c)),l=Math.min(s,Math.floor(n+(a-h)*f/a+c));e(t,o,n,d,l,u)}var m=o[2*n+u],v=r,g=s;for(i(t,o,r,n),o[2*s+u]>m&&i(t,o,r,s);g>v;){for(i(t,o,v,g),v++,g--;o[2*v+u]<m;)v++;for(;o[2*g+u]>m;)g--}o[2*r+u]===m?i(t,o,r,g):(g++,i(t,o,g,s)),n>=g&&(r=g+1),g>=n&&(s=g-1)}}function i(t,o,n,e){r(t,n,e),r(o,2*n,2*e),r(o,2*n+1,2*e+1)}function r(t,o,n){var e=t[o];t[o]=t[n],t[n]=e}o.exports=n},{}],5:[function(t,o){"use strict";function n(t,o,n,i,r,s){for(var u=[0,t.length-1,0],a=[],h=r*r;u.length;){var p=u.pop(),f=u.pop(),c=u.pop();if(s>=f-c)for(var d=c;f>=d;d++)e(o[2*d],o[2*d+1],n,i)<=h&&a.push(t[d]);else{var l=Math.floor((c+f)/2),m=o[2*l],v=o[2*l+1];e(m,v,n,i)<=h&&a.push(t[l]);var g=(p+1)%2;(0===p?m>=n-r:v>=i-r)&&(u.push(c),u.push(l-1),u.push(g)),(0===p?n+r>=m:i+r>=v)&&(u.push(l+1),u.push(f),u.push(g))}}return a}function e(t,o,n,e){var i=t-n,r=o-e;return i*i+r*r}o.exports=n},{}]},{},[1])(1)});